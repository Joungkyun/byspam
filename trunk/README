By Spam README File
-------------------

$Id$


소개

By SPAM 은 스팸메일 때문에 이 프로그램이 만들어 졌다는 의미입니다. 이 프로그램은
procmail 에 의해 호출이 되어지며, perl 로 작성이 되어져 있습니다.

필터링은 메일 헤더에서 제목, From, To, Date 를 할 수 있으며, 이 외의 헤더에 대해
서 사용자 지정을 하여 필터링 할 수 있습니다. 또한 메일 본문 역시 필터링이 가능하
며, plain, base64, qouted-printable 인코딩 된 모든 메일을 필터링 할 수 있습니다.

또한, 필터링 문자는 perl 의 정규표현식을 이용하여 필터링을 하기 때문에 아주 강력
하지만, 대신 아주 조심해서 설정을 해 주셔야 합니다.  이 프로그램을 사용하기 위해
서는 간단한 정규 표현식에 대해서는 이해를 하셔야 합니다. 이를 위해서 regexChk 라
는 유틸리티를 지원 합니다.

1.0.0 부터는 charset 을 체크하여 변환을 하도록 지원이 추가가 되었습니다. EUC-KR
시스템에서 UTF8 메일을 체크하지 못하던 또는 UTF8 시스템에서 EUC-KR 로 오는 메일
을 처리하지 못하던 문제가 해결이 되었습니다.



주의 사항

By SPAM 의 필터링 방식은 인코딩 되어 있는 내용들을 우리가 인식을 할 수 있도록 디
코딩을 하여 필터링을 하는 방식입니다.  하지만 이 디코딩시의 문제는 한글 문자셋에
대해서만 필터링이 가능합니다. 영어와 EUC-KR KSX 5601 UTF8 이외의 문자셋에 대해서
는 정상작동을 하지 못합니다.



프로그램 구조

  .
  |-- Changelog
  |-- ENVIRONMENT
  |-- INSTALL
  |-- LICENSE
  |-- Makefile.in
  |-- README
  |-- REGEX
  |-- VERSION
  |-- bin
  |   |-- byspamFilter
  |   |-- byspamPlain
  |   |-- byspamTrash
  |   |-- byspamTrashMgr
  |   `-- byspamRegexChk
  |-- byspam.spec
  |-- config.h.in
  |-- configure
  |-- configure.ac
  |-- etc
  |   |-- byspam.cron
  |   |-- byspam.conf
  |   |-- byspam.conf.ko
  |   `-- filter.rc
  |-- filter
  |   |-- filter-allow
  |   |-- filter-body
  |   |-- filter-date
  |   |-- filter-extra
  |   |-- filter-from
  |   |-- filter-ignore
  |   |-- filter-subject
  |   `-- filter-to
  |-- include
  |   |-- Common.pm
  |   |-- Encode.pm
  |   |-- Getopt.pm
  |   |-- Mail.pm
  |   |-- Parse.pm
  |   `-- Trash.pm
  `-- install-sh


* Changelog

By SPAM 의 개발 일지

* ENVIRONMENT

By SPAM 을 사용하기 위한 환경에 대한 설명을 하고 있습니다.

* LICENSE

By SPAM 의 저작권을 명시하는 파일입니다. BSA 는 BPL License 를 따릅니다.

* README

현재 읽고 있는 파일입니다.

* REGEX

정규식에 관한 문서입니다. 사용 시 참고 하시기 바랍니다.

* bin/byspamTrashMgr

Trash 에 있는 메일을 byspam.conf 에 지정되어 있는 일 수에 따라 삭제를 합니다. 하
루에 한번씩 작동하게 되어 있습니다. /etc/cron.d/byspam 에서 호출이 되어집니다.

* bin/byspamFilter

By SPAM 에서 메일 필터링을 수행하는 파일 입니다. @bindir@/byspamFilter 로 설치가
됩니다.

* bin/byspamTrash

By SPAM 에 의해 필터링이 된 파일들은 각 계정의 홈디렉토리의 byspam 이라는 디렉토
리에 일별로 저장이 됩니다. 이 저장된 Trash 파일들을 관리하는 프로그램입니다.

각 계정에서는 byspamTrash 명령을 실행하여 각 날자별의 Trash 파일의 리스트를 확인
할 수 있으며, 해당 번호를 입력하여 해당 날자의 필터링 된 메일을 확인할 수 있습니
다.

root 유저의 경우에는 "byspamTrash 계정이름"으로 실행하여 각 계정별의 필터링된 메
일을 확인할 수 있습니다.

byspamTrash 는 메일의 삭제와 복구를 지원합니다.

* bin/byspamPlain

인코딩 되어 있는 메일을 평문으로 변경하는 파일입니다. 이는 메일 처리 과정과는 아
무 상관이 없으며, 개발시 확인작업을 하는데 유용하게 사용됩니다. 설치 후,
@bindir/byspamPlain 으로 설치가 됩니다.

* bin/byspamRegexChk

필터링을 할 때 설정한 필터링이 정확한가를 확인을 하기 위해 사용할 수 있는 유틸리
티 입니다.  By SPAM 의 경우에는 필터링을 펄의 정규표현식을 이용하기 때문에, 아주
유의해서 설정을 해야하기 때문에 이 유틸리티의 사용을 적극 권장합니다.
@bindir@/byspamRegexChk 로 설치가 됩니다.

* bin/byspamReload

byspam 은 1.0 부터 shared memory 를 사용할 수 있게 설계되어 있다. 즉, perl 모듈
IPC::ShareLite 모듈이 존재하면, 자동으로 shared memory 를 사용하게 되어 있으며,
이 경우에는 설정파일을 변경했을 경우, byspamReload 로 공유 메모리를 업데이트 시
켜 주어야 한다. IPC::ShareLite 모듈이 설치되지 않았을 경우에는 실행될 때마다 설
정 파일과 필터파일을 읽으므로, 변경 즉시 반영이 되지만, 공유 메모리를 사용할 경
우에는 공유메모리에 아무 정보도 없을 경우만, 공유 메모리에 설정을 올리기 때문에,
구동중에 변경을 한다면, 이 명령을 이용해서 갱신해 줘야 한다.

* bin/byspamClear

공유 메모리 기능을 사용할때 공유 메모리의 byspam 설정을 clear 시킨다. 단, 이 명
령을 사용할 경우, 해당 구동시에 실행되던 byspam 작동은 모두 오류를 발생 시킨다.
byspam 을 더이상 사용하지 않을 경우에 또는, 모든 byspam 구동을 멈췄다고 판단 될
경우에만 사용하도록 한다. IPC::ShareLite 모듈이 설치되지 않았을 경우, 이 파일은
아무 작동도 하지 않는다.

* byspam.spec

RPM 패키지를 만들기 위한 spec 파일 입니다. byspam 을 RPM package로 제작하고 싶다
면 rpm -ta byspam-version.tar.gz 명령으로 압축을 풀지 않고 생성할 수 있습니다.

* configure

By SPAM 을 설치준비를 위한 수행 파일입니다.

* etc/byspam.conf

몇가지 옵션을 설정할 수 있습니다. @confdir@/byspam.conf 로 설치가 됩니다. INSTALL
파일을 참고 하십시오.

* etc/filter.rc

procmail 과 By SPAM 을 연결하여 주는 파일입니다. 계정 유저레벨에서 By SPAM 을 사
용하는 경우 사용자 로그를 이 파일에서 설정을 할 수 있습니다. @confdir@/filter.rc
로 설치가 됩니다.

* filter/*

실제로 사용자가 필터링을 설정하는 파일입니다. 이 파일은 펄의 정규표현식으로 작성
을 하므로 상당히 강력하게 필터링을 가능하게 합니다만,  잘못 설정했을 경우에는 엉
뚱한 메일을 날려 버릴 수 있으므로 regexChk.pl 과 필터링된 메일을 저장해 놓을것을
권장합니다. @confdir@/Filter/* 또는 @filterdir@/* 으로 설치가 됩니다.


   filter-allow   : 아래의 필터링 룰에 걸렸지만 예외 규정을 둘 때 사용합니다.
   filter-body    : 메일 본문을 필터링 합니다.
   filter-date    : 메일 헤더의 Date 헤더를 체크합니다.
   filter-extra   : 파싱이 된 메일 헤더 전체를 체크합니다. 헤더이름 역시 체크 가
                    능 합니다. 또한 파싱되지 않은 메일 본문의 문자열을 필터링 할
                    수 있습니다. 즉, 메일 본문의 multipart 헤더들을 체크할 수 있
                    습니다.
   filter-from    : 메일 헤더의 From 헤더를 체크합니다.
   filter-ignore  : fileter-allow 를 무력화 할 단어를 등록합니다.
   filter-subject : 메일 헤더의 메일 제목 헤더를 체크합니다.
   filter-to      : 메일 헤더의 To 헤더를 체크합니다.

* include/*

byspam 을 실행할 때 필요한 perl package 들 입니다.

* Makefile.in

configure 에 의해서 Makefile 을 만들기 위한 templete 이다.
